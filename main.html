<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-CN">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<!--<meta http-equiv="X-UA-Compatible" content="IE=edge">-->
        <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8">
		<title>RMS配置中心</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
		<!-- Bootstrap -->
		<link href="lib/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
		<!--[if lte IE 6]>
		  <link rel="stylesheet" type="text/css" href="lib/bsie/css/bootstrap-ie6.css">
		  <link rel="stylesheet" type="text/css" href="lib/bsie/css/ie.css">
		<![endif]-->
		<link href="lib/tools/webtools.css" rel="stylesheet" media="screen" />
		<link href="lib/jq-ui/jquery-ui-1.9.2.custom.css" rel="stylesheet" media="screen" />
        <link href="lib/jq-ui/themes/smoothness/jquery-ui.css" rel="stylesheet" />
        <link href="lib/ztree/zTreeStyle.css" rel="stylesheet">
        <link href="lib/posa-ui/css/posa-ui.css" rel="stylesheet" media="screen" />
		<link href="css/main.css" rel="stylesheet" media="screen" />

        <script type="text/javascript" src="lib/bootstrap/js/ie8/html5shiv.min.js"></script>
        <script type="text/javascript" src="lib/bootstrap/js/ie8/respond.min.js"></script>

	</head>
	<body>
		<div class="panel panel-primary well well-sm hide">
			<div class="panel-heading">
				<div class="navbar-primary" role="navigation">
					<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
						<ul class="nav navbar-nav">
							<li class="active">
								<h1 class="panel-title lead" style="font-size:30px;">RMS配置中心</h1>
							</li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li>
								<a class="title-a-color" id="btnLoginout" href="#">退出登录</a>
							</li>

						</ul>
					</div>
				</div>
			</div>
			<div class="panel-body">
				<ul class="nav nav-tabs">
					<li>
						<a href="#home" data-toggle="tab">主页</a>
					</li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">用户管理<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li>
								<a href="#messages" id="tab_userset" data-toggle="tab">用户设置</a>
								<a href="#messages" id="tab_modifypsd" class="hide" data-toggle="tab">修改密码</a>
							</li>
							<li class="divider"></li>
						</ul>
					</li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">系统设置<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li>
								<a href="#settings" data-toggle="tab">服务器设置</a>
							</li>
							<li class="divider"></li>
						</ul>
					</li>
				</ul>

				<!-- Tab panes -->
				<div class="tab-content lead">
					<div class="tab-pane text-center text-primary hide" id="home" style="height: 300px; margin-top: 100px;">
							<h1>欢迎来到《RMS配置中心》</h1>RMSConfig_V1.0.0
                            <h4><span id="tryVersion" class="hide">您当前使用的是试用版本, </span><a href="authorization.html" style="color:red;">点我进入授权页面!</a></h4>
					</div>
					<div class="tab-pane active hide" id="messages">
						<div class="row userlist_div" id="userlist">
							<div class="col-xs-1">&nbsp;</div>
							<div class="col-xs-10">
								<div class="panel panel-default">
									<!-- Default panel contents -->
									<div class="panel-heading">
										用户列表
									</div>
									<div class="panel-body ">
										<div class="col-xs-3">
											<input id="searchName" type="text" class="form-control" placeholder="输入用户名...">
										</div>
										<div class="col-xs-1">
											<button id="btnSearchName" type="button" class="btn btn-primary">
												搜索
											</button>
										</div>
										<div class="col-xs-4">
											&nbsp;
										</div>
										<div class="col-xs-4">
												<button id="btnAddUser" type="button" class="btn btn-primary">
													添加用户
												</button>
                                                <button id="btnResetPwd" type="button" class="btn btn-primary">
                                                    重置密码
                                                </button>
												<button id="btnBatchRemove" type="button" class="btn btn-primary">
													批量删除
												</button>

										</div>
									</div>
									<div id="userlist_table">

									</div>
								</div>
							</div>
						</div>
						<div class="row hide" id="bindChanel">
							<div class="col-xs-12">
								<div class="col-xs-9">&nbsp;</div>
								<div class="col-xs-3">
									<button class="btn btn-primary hide" id="btnSaveBindChannel">保存设置</button>
									<a class="btn btn-primary" id="btnModifyPwd" href="#" role="button">修改密码</a>
									<a class="btn btn-primary" name="returnlist" href="#" role="button">返回列表</a>
								</div>	
							</div>
							<div class="col-xs-12">
								<div class="col-xs-3">&nbsp;</div>
								<div class="col-xs-5" style="text-align: center;">
									用户 <span id="bindChanel_name">admin</span> 绑定的设备
								</div>
								<div class="col-xs-4">&nbsp;</div>
							</div>
                            <div class="col-xs-12">
                                <div class="col-xs-3">&nbsp;</div>
                                <div class="col-xs-5 h4" style="text-align: center; padding: 0;">
                                    <div class="col-xs-5" style="padding: 0;">
                                        <div class="col-xs-8" style="padding: 0;">
                                            <input type="text" placeholder="输入通道名称..." class="form-control" id="channelSearchName" />
                                        </div>
                                        <div class="col-xs-4" style="padding: 0;">
                                            <button class="btn btn-primary" type="button" id="btnSearchChannelByName">查找</button>
                                        </div>
                                    </div>
                                    <div class="col-xs-1" style="padding: 0;">
                                        <button class="btn btn-primary" type="button" id="btnRefreshChannelList">刷新</button>
                                    </div>
                                    <div class="col-xs-1" style="padding: 0;">
                                    </div>
                                    <div class="col-xs-5" style="padding: 0;">
                                        <div class="col-xs-6">
                                            <button class="btn btn-primary" type="button" id="btnCheckAllNodes">全部选择</button>
                                        </div>
                                        <div class="col-xs-6">
                                            <button class="btn btn-primary" type="button" id="btnUncheckAllNodes">全部取消</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-4">&nbsp;</div>
                            </div>
							<div class="col-xs-12">
								<div class="col-xs-5 h5" id="bindChanel_list"  style="margin-left:25%;">
                                    <ul class="ztree" id="channelList-list"></ul>
								</div>
								<div class="col-xs-4">&nbsp;</div>
							</div>
						</div>
						<div class="row hide" id="adduser">
                            <div class="col-xs-10">&nbsp;</div>
							<div class="col-xs-2">
								<a class="btn btn-primary" name="returnlist" href="#" role="button">返回列表</a>
							</div>
                            <div class="col-xs-5">&nbsp;</div>
							<div class="col-xs-2">
								添加用户
							</div>
                            <div class="col-xs-5">&nbsp;</div>
                            <div class="col-xs-5">&nbsp;</div>
							<div class="col-xs-3 border h5">
								<div class="form-group">
									<label for="inputAdduser_name">用户名</label>
									<input type="email" class="form-control" id="inputAdduser_name" placeholder="用户名">
								</div>
								<div class="form-group">
									<label for="inputAdduser_pwd">密码</label>
									<input type="password" class="form-control" id="inputAdduser_pwd" placeholder="密码">
								</div>
								<div class="form-group">
									<label for="inputAdduser_pwdr">重复密码</label>
									<input type="password" class="form-control" id="inputAdduser_pwdr" placeholder="重复密码">
								</div>
                                <div class="col-xs-6">&nbsp;</div>
								<div class="col-xs-2">
									<button type="submit" class="btn btn-primary" id="btnSaveUser">
										添加用户
									</button>
								</div>
							</div>
						</div>
						<div class="row hide" id="updateuser">
							<div class="col-xs-9">&nbsp;</div>
							<div class="col-xs-3">
								<a class="btn btn-primary" id="btnSavePwd" name="btnSavePwd" href="#" role="button">确认修改</a>&nbsp;
								<a class="btn btn-primary" id="mdypwdreturnlist" name="returnlist" href="#" role="button">返回列表</a>
							</div>
                            <div class="col-xs-4">&nbsp;</div>
							<div class="col-xs-4" style="text-align: center;">
								修改用户<span id="modifyPwd_name">admin</span>的密码
							</div>
							<div class="col-xs-4">&nbsp;</div>
							<div class="col-xs-4">&nbsp;</div>
							<div class="col-xs-4 border h5">
								<div class="form-group">
									<label for="inputModifypwd_pwdo">旧密码</label>
									<input type="password" class="form-control" id="inputModifypwd_pwdo" placeholder="旧密码">
								</div>
								<div class="form-group">
									<label for="inputModifypwd_pwdn">新密码</label>
									<input type="password" class="form-control" id="inputModifypwd_pwdn" placeholder="新密码">
								</div>
								<div class="form-group">
									<label for="inputModifypwd_pwdnr">重复密码</label>
									<input type="password" class="form-control" id="inputModifypwd_pwdnr" placeholder="重复密码">
								</div>
							</div>
						</div>
						<div class="row userlist_div hide" id="usercheck">
                            <div class="col-xs-10">&nbsp;</div>
							<div class="col-xs-2">
								<a class="btn btn-primary" name="returnlist" href="#" role="button">返回列表</a>
							</div>
                            <div class="col-xs-4">&nbsp;</div>
							<div class="col-xs-6">
								<div class="col-xs-10 h3">
									用户<span id="userlist_name">admin</span>的设备列表
								</div>
								<div class="col-xs-8 col-md-offset-1 h5" style="height:350px; widht:500px; overflow: scroll;">
									<ul class="ztree" id="deviceList-list"></ul>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="settings">
						<div class="row">
							<div class="col-xs-12">
								&nbsp;
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								命令加密
							</div>
							<div class="col-xs-2 pbm">
								<input type="checkbox" id="command_encryption" />
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								鉴权方法
							</div>
							<div class="col-xs-2">
								<div class="btn-group">
									<button type="button" id="authentication" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
										<span>local</span>&nbsp;<span class="caret"></span>
									</button>
									<ul class="dropdown-menu pull-right" role="menu">
										<li>
											<a href="#">local</a>
										</li>
										<li>
											<a href="#">cms</a>
										</li>
										<li>
											<a href="#">rms</a>
										</li>
                                        <li>
											<a href="#">vrm</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								心跳超时
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="heartbeat_timeout" type="text" class="form-control" placeholder="(0-60)秒">
								</div>
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								上级RMS地址
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="superior_rms_address" type="text" class="form-control" placeholder="">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								RMS ID
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="rms_id" type="text" class="form-control" readonly placeholder="">
								</div>
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								上级RMS端口
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="superior_rms_port" type="text" class="form-control" placeholder="">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								RMS TITLE
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="rms_title" type="text" class="form-control" placeholder="">
								</div>
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								CMS地址
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="cms_url" type="text" class="form-control" placeholder="">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								RMS对外服务地址
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="rms_foreign_address" type="text" class="form-control" placeholder="">
								</div>
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								RMS对外服务端口
							</div>
							<div class="col-xs-2">
								<div class="input-group input-group-sm" style="width:90%;">
									<input id="rms_foreign_port" type="text" class="form-control" placeholder="">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-1 col-md-offset-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
								流是否加密
							</div>
							<div class="col-xs-2">
								<input type="checkbox" id="stream_encryption" />
							</div>
							<div class="col-xs-1">
								&nbsp;
							</div>
							<div class="col-xs-2">
                                备注
							</div>
							<div class="col-xs-2">
                                <div class="input-group input-group-sm" style="width:90%;">
                                    <input id="remark" type="text" class="form-control" placeholder="输入备注">
                                </div>
							   </div>
                            <div class="col-xs-1">
                                &nbsp;
                            </div>
						</div>
						<div class="row">
                            <div class="col-xs-5">&nbsp;</div>
							<div class="col-xs-1">
								<button id="btnSaveParamCfg" type="button" class="btn btn-primary">
									保存设置
								</button>
							</div>
							<div class="col-xs-2">
								<button id="btnRebootDevice" type="button" class="btn btn-primary">
									重启设备
								</button>
							</div>
							<div class="col-xs-2"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
        <div id="playerDiv"  style="float: left;z-index: 101;"> </div>
        <div id="dialog-cover" class="itsai-layer dialog-cover"></div>
        <div id="frm_dialog" class="dialog">
            <iframe src="" style="position:absolute;left:0px;top:0px;width:100%;height:100%;z-index:0;scrolling:no;" frameborder="0"></iframe>
            <div style="z-index:10;position:relative;" class="dialog-border">
                <div class="dialog-title">
                    <!--<div class="dialog-icon dialog-icon-user"></div>-->
                    <span class="dialog-close"></span> <span class="title-name"></span></div>
                <!--<div class="dialog-content"></div>--><br/>
                <form id="frm-upgradeControl" name="frm-upgradeOL" class="inner-box small" style="color: #4882B5;">
                    <label class="lbl" id="upgradeCrtl_description" style="margin: 20px;">
                    </label>
                    <br/>
                    <div class="form-btn-group-dialog txt-right">
                        <button type="button" style="margin-left: 200px;" id="frm-upgradeControl-submit" name="frm-storage-submit" class="btn btn-primary">更&nbsp;新&nbsp;控&nbsp;件 </button>
                    </div>
                </form>
                <!--//////////////////////////////////////////////////////////////-->
                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<!--<script src="lib/jquery-1.10.2.js"></script>-->
        <script type="text/javascript" src="lib/jquery-1.7.2.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script type="text/javascript" src="lib/bootstrap/js/bootstrap.js"></script>
		<!--[if lte IE 6]>
		  <script type="text/javascript" src="lib/bsie/js/bootstrap-ie.js"></script>
		<![endif]-->
		<script src="lib/md5-min.js" type="text/javascript"></script>
		<script src="lib/jquery.cookie.js" type="text/javascript"></script>
		<script src="lib/json2.js" type="text/javascript"></script>
		<script src="lib/jq-ui/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>
        <script src="lib/posa-ui/posa-ui.js" type="text/javascript"></script>
        <script src="lib/ztree/jquery.ztree.all-3.5.js" type="text/javascript"></script>
        <script type="text/javascript" src="lib/jquery-additional.js"></script>
        <script src="lib/ztree/jquery.ztree.exhide-3.5.js" type="text/javascript"></script>
        <script src="lib/videoPlugin/js/VideoControl.js" type="text/javascript"></script>
		<script src="lib/tools/app.js" type="text/javascript"></script>
		<script src="js/main.js" type="text/javascript"></script>
		<script src="js/dialog.js" type="text/javascript"></script>
		<script src="js/user.js" type="text/javascript"></script>
		<script src="js/paramcfg.js" type="text/javascript"></script>
        <script src="js/tree.js" type="text/javascript"></script>
        <script src="js/player.js" type="text/javascript"></script>
		<script type="text/javascript">
			$(document).ready(function() {

                if (HAT.Main.agent().name == 'msie' && parseInt(HAT.Main.agent().version, 10) < 8) {
                    HAT.Main.layer.add('');
                    $('#login-container').remove();
                    alert('您的浏览器版本过低，为给您更好的体验，请使用IE8及以上版本（或Firefox,Chrome等）浏览器！');
                    return;
                }

                $("#rms_foreign_address").vIP();
                $("#superior_rms_address").vIPv4();
                //$("#cms_url").vIPv4();

				//TODO
				$("a[name='returnlist']").bind("click", function() {
					$("#messages > div").removeClass("show").addClass("hide");
					$("#userlist").addClass("show");
					
					HAT.User.initPage();
				});
				
					//添加用户
				$("#btnAddUser").bind("click", function() {
					HAT.User.showAddUser();
				});

                //查找用户
				$("#btnSearchName").on("click", function() {
					HAT.User.searchUserByName();
				});
				
				//保存用户
				$("#btnSaveUser").bind("click", function() {
					HAT.User.saveAddUser();
				});

                //删除用户
				$("#btnBatchRemove").bind("click", function() {
					HAT.User.batchRemoveUser();
				});

                //重置密码
				$("#btnResetPwd").bind("click", function() {
					HAT.User.resetUserPwd();
				});

				//修改用户密码
				$("#btnModifyPwd").bind("click", function() {
					var name = $("#bindChanel_name").text();
					if( name != "" ){
						HAT.User.showModifyPwd(name);
					}
				});

                //修改用户密码
                $("#tab_modifypsd").bind("click", function() {
                    var name = $("#bindChanel_name").text();
                    if( name != "" ){
                        HAT.User.showModifyPwd(name);
                    }
                });

				$("#btnSavePwd").bind("click", function() {
					HAT.User.saveModifyPwd();
				});

                //保存绑定的通道
                $("#btnSaveBindChannel").bind("click", function() {
                    HAT.User.saveBindChannel();
                });

                //刷新树
                $("#btnRefreshChannelList").bind("click", function(){
                    HAT.User.refreshChannelList();
                });

                //选择所有节点
                $("#btnUncheckAllNodes").bind("click", function(){
                    HAT.User.checkAllNodes(false);
                });

                //取消所有节点的全选
                $("#btnCheckAllNodes").bind("click", function(){
                    HAT.User.checkAllNodes(true);
                });

                //搜索通道
                $("#btnSearchChannelByName").bind("click", function(){
                    HAT.User.searchChannelByName();
                });

                HAT.Player.init();

                //判断是否为试用版
                HAT.ajax.post(HAT.target.authkey, "get", {}, function (data) {
                    if( data.data ){
                        if( data.data.status == 0 ){
                            $("#home").addClass("active").removeClass("hide");
                            $("#messages").removeClass("active").removeClass("hide");
                            $("#tryVersion").removeClass("hide");
                        }else if( data.data.status == 1 ){
                            $("#messages").removeClass("hide");
                            $("#home").removeClass("hide");
                        }else if( data.data.status == 2 ){   //如果授权已经过期 就跳回登录页面
                            window.location.href = "index.html";
                        }
                    }
                });

                $.widget( "custom.catcomplete", $.ui.autocomplete, {
                    _renderMenu: function( ul, items ) {
                        var that = this,
                                currentCategory = "";
                        $.each( items, function( index, item ) {
                            if ( item.category != currentCategory ) {
                                ul.append( "<li class='ui-autocomplete-category'>" + item.category + "</li>" );
                                currentCategory = item.category;
                            }
                            that._renderItemData( ul, item );
                        });
                    }
                });

                window.onunload = function(){
                    HAT.IsClose();
                };
			});
		</script>
	</body>
</html>
