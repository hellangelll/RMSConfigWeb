/*! rmsWebconfig 2014-03-14 author:hellangel*/
!function(){window.HAT||(window.HAT={})}(),HAT.Param={param:{},initPage:function(){$("#btnLoginout").bind("click",function(){HAT.logout(function(){window.location.href="index.html"})}),$("#btnSaveParamCfg").bind("click",function(){HAT.Param.saveParamCfg()}),$("#btnRebootDevice").bind("click",function(){confirm("您确定要重启设备吗!")&&HAT.Param.saveRebootDevice()}),$("#authentication ~ ul a").bind("click",function(){$("#authentication span:first").text($(this).text())}),this.getParamCfg()},getParamCfg:function(){var a={};HAT.ajax.post(HAT.target.paramcfg,"get",a,function(a){0==a.status&&($(".panel-primary").removeClass("hide"),HAT.Param.param=a.data,HAT.Param.initParam(a.data),HAT.treeRootName=a.data.rms_id,HAT.Tree._oTreeRoot.id=a.data.rms_id,HAT.Tree._oTreeRoot.name=a.data.rms_title,HAT.Player.initData())})},setParamCfg:function(a){return a?void HAT.ajax.post(HAT.target.paramcfg,"set",a,function(a){0==a.status&&HAT.msg.infoAlert("参数配置成功, <span style='color:red;'>需要重启设备才会生效</span>!")}):!1},initParam:function(a){a.command_encryption?$("#command_encryption").attr("checked",!0):$("#command_encryption").attr("checked",!1),a.stream_encryption?$("#stream_encryption").attr("checked",!0):$("#stream_encryption").attr("checked",!1),$("#heartbeat_timeout").val(a.heartbeat_timeout),$("#superior_rms_address").val(a.superior_rms_address),$("#rms_id").val(a.rms_id),$("#superior_rms_port").val(a.superior_rms_port),$("#rms_title").val(a.rms_title),$("#cms_url").val(a.cms_url),$("#rms_foreign_address").val(a.rms_foreign_address),$("#rms_foreign_port").val(a.rms_foreign_port),$("#authentication span:first").text(a.authentication),$("#remark").val(a.remark),"local"!=a.authentication?($("#tab_userset").addClass("hide"),$("#mdypwdreturnlist").addClass("hide"),$("#tab_modifypsd").removeClass("hide")):($("#tab_modifypsd").addClass("hide"),$("#tab_userset").removeClass("hide"),$("#mdypwdreturnlist").removeClass("hide"))},saveParamCfg:function(){var a={};if(a.command_encryption=$("#command_encryption").is(":checked"),""!=$("#authentication span:first").text()&&(a.authentication=$("#authentication span:first").text()),""==$("#heartbeat_timeout").val())return HAT.msg.infoWarning("请输入合法心跳超时时间!"),!1;if(a.heartbeat_timeout=$("#heartbeat_timeout").val(),""!=$("#superior_rms_address").val())a.superior_rms_address=$("#superior_rms_address").val();else if("rms"==a.authentication)return HAT.msg.infoWarning("上级RMS地址只能是IP地址!"),!1;if(""==$("#rms_id").val())return HAT.msg.infoWarning("请输入合法RMS ID!"),!1;if(a.rms_id=$("#rms_id").val(),""!=$("#superior_rms_port").val())a.superior_rms_port=$("#superior_rms_port").val();else if("rms"==a.authentication)return HAT.msg.infoWarning("请输入合法上级RMS端口!"),!1;if(""==$("#rms_title").val())return HAT.msg.infoWarning("请输入合法RMS TITLE!"),!1;if(a.rms_title=$("#rms_title").val(),""!=$("#cms_url").val())a.cms_url=$("#cms_url").val();else if("vrm"==a.authentication||"cms"==a.authentication)return HAT.msg.infoWarning("请输入正确的CMS URL地址!"),!1;return""==$("#rms_foreign_address").val()?(HAT.msg.infoWarning("请输入正确的RMS URL地址!"),!1):(a.rms_foreign_address=$("#rms_foreign_address").val(),""==$("#rms_foreign_port").val()?(HAT.msg.infoWarning("请输入合法RMS对外服务端口!"),!1):(a.rms_foreign_port=$("#rms_foreign_port").val(),a.stream_encryption=$("#stream_encryption").is(":checked"),a.remark=$("#remark").val(),void HAT.Param.setParamCfg(a)))},saveRebootDevice:function(){HAT.ajax.post(HAT.target.restart,"set",{},function(a){0==a.status&&alert("设备即将重启,请稍等片刻!")})}};